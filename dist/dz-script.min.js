!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).dzUtils={})}(this,function(e){"use strict";function t(e,t){return Object.prototype.toString.call(e)===`[object ${t}]`}function n(e){return t(e,"Undefined")}function r(e){return t(e,"Null")}function i(e){return t(e,"Object")}function o(e){return Array.isArray(e)&&0===e.length}function a(e){return i(e)&&0===Object.keys(e).length}function s(e){return r(e)||n(e)||""===e||o(e)||a(e)}function c(o,a,s,c){return new(s=s||Promise)(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})}let l={SIGN_END:"SIGN_END",SIGN_END_OK:"SIGN_EN_OK",SIGN_START:"SIGN_START",SIGN_START_OK:"SIGN_START_OK"};function d(e){var t=e.replace(/\n/g,""),n={nodeName:"root",children:[]};let r=[0],o=0,a=n,s="",i="";for(var c=0;c<t.length;c++){var d=t.charAt(c),f=t.charAt(c+1);"<"===d?(s&&i===l.SIGN_START_OK&&(a.text=s,s=""),i="/"===f?l.SIGN_END:l.SIGN_START):">"===d?(i===l.SIGN_START&&(a=n,r.map((e,t)=>{if(a.children||(a.children=[]),t===r.length-1){var t=(s=s.replace(/^\s*/g,"").replace(/\"/g,"")).match(/^[a-zA-Z0-9]*\s*/)[0].replace(/\s/g,""),i=s.replace(t,"").replace(/\s+/g,",").split(",");let n={},r={};i.map(e=>{if(e){var t=e.split("=")[1],e=e.split("=")[0];if("style"===e)return t.split(";").map(e=>{e&&(r[e.split(":")[0]]=e.split(":")[1])}),n[e]=r;n[e]=t}}),a.children.push(Object.assign({nodeName:t,children:[]},n))}o=a.children.length-1,a=a.children[o]}),r.push(o),s="",i=l.SIGN_START_OK),i===l.SIGN_END&&(r.pop(),a=n,r.map(e=>{var t;a=null==(t=null===a||void 0===a?void 0:a.children)?void 0:t[e]}),s="",i=l.SIGN_END_OK)):s+=d}return n}e.REFEXP_IPV6=/(^(?:(?:(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$)|(^\[(?:(?:(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))\](?::(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]))?$)/i,e.REGEXP_CODE_FOUR=/^\d{4}$/,e.REGEXP_CODE_SIX=/^\d{6}$/,e.REGEXP_EMAIL=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,e.REGEXP_IPV4=/^(?:(?:2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(?:2[0-4]\d|25[0-5]|[01]?\d\d?)$/,e.REGEXP_PHONE=/^[1](([3]\d)|([4][0-1,4-9])|([5][0-3,5-9])|([6][2,5-7])|([7][0-8])|([8]\d)|([9][0-3,5-9]))\d{8}$/,e.REGEXP_PWD=/^(?!\d+$)(?![a-z]+$)(?![A-Z]+$)(?!([^(0-9a-zA-Z)]|[()])+$)(?!^.*[\u4E00-\u9FA5].*$)([^(0-9a-zA-Z)]|[()]|[a-z]|[A-Z]|\d){8,18}$/,e.REGEXP_URL=/(((^https?:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+(?::\d+)?|(?:www.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[\w]*))?)$/,e.animate=function(r,i,o,a){let s=performance.now();requestAnimationFrame(function e(t){let n=(t-s)/a;1<n&&(n=1),o(r+(i-r)*n),n<1&&requestAnimationFrame(e)})},e.appendData=function(t,n){n&&Object.keys(n).forEach(e=>{t.append(e,n[e])})},e.clearLocal=function(){window.localStorage.clear()},e.clearSession=function(){window.sessionStorage.clear()},e.deepMerge=function t(n={},r={}){return Object.keys(r).forEach(e=>{n[e]=i(n[e])?t(n[e],r[e]):n[e]=r[e]}),n},e.delay=function(t=1e3){return new Promise(e=>{setTimeout(e,t)})},e.downloadFile=(e,t)=>{const n=document.createElement("a");document.body.appendChild(n),n.download=t||"",n.href=e,n.click(),setTimeout(()=>document.body.removeChild(n))},e.formatStringToJson=function(e){if(s(e))return null;try{return JSON.parse(e)}catch(e){throw new Error(e)}},e.getLocal=function(e){return(e=window.localStorage.getItem(e))||null},e.getSession=function(e){e=sessionStorage.getItem(e);let t=null;if(e)try{t=String(e)}catch(e){}return t},e.groupBy=function(e,t){if("string"==typeof t){const i=t;t=e=>e[i]}var n={};for(const o of e){var r=t(o);n[r]||(n[r]=[]),n[r].push(o)}return n},e.htmlTransform=d,e.isArray=function(e){return e&&Array.isArray(e)},e.isEmpty=s,e.isEmptyArray=o,e.isEmptyObject=a,e.isFunction=function(e){return t(e,"Function")},e.isNull=r,e.isNullOrUnDef=function(e){return n(e)||r(e)},e.isObject=i,e.isString=function(e){return t(e,"String")},e.isUndefined=n,e.removeLocal=function(e){window.localStorage.removeItem(e)},e.removeSession=function(e){window.sessionStorage.removeItem(e)},e.serialize=function(t){const n=new URLSearchParams("");return Object.keys(t).forEach(e=>{n.append(e,t[e])}),n.toString()},e.setLocal=function(e,t){window.localStorage.setItem(e,String(t))},e.setSession=function(e,t){sessionStorage.setItem(e,String(t))},e.updateWorkerjs=class{constructor(e){this.path=e.path,this.pollingTime=e.pollingTime||15,this.myWork=void 0,this.scriptUrl=e.scriptUrl,this.eventMap=new Map,this.eventMap.set("update",new Set),this.eventMap.set("close",new Set),this.createWorkerjs()}on(e,t){this.eventMap.get(e).add(t)}off(e,t){this.eventMap.get(e).delete(t)}emit(e){this.eventMap.get(e).forEach(e=>{e(this,this)})}_error(e){throw new Error(e)}_getHtmlObj(){return c(this,void 0,void 0,function*(){return d(yield(yield fetch(window.location.origin,{method:"GET"})).text())})}_getCurrentHash(e){for(const n of e.children){if("script"===(null===n||void 0===n?void 0:n.nodeName)&&null!==n&&void 0!==n&&n.src)return n.src;var t=this._getCurrentHash(n);if(null!==t)return t}return null}_getScript(){return fetch(this.scriptUrl||"https://static.flytodream.cn/dz-reload.js",{method:"get"}).then(e=>e.text())}createWorkerjs(){return c(this,void 0,void 0,function*(){var e,t=yield this._getHtmlObj(),t=this._getCurrentHash(t);window.Worker?(e=yield this._getScript(),e=window.URL.createObjectURL(new Blob([e],{type:"application/javascript"})),this.myWork=new Worker(e),this.myWork.postMessage({pollingTime:this.pollingTime,location:this.path||window.location.origin,currentHash:t}),this.myWork.onmessage=t=>c(this,void 0,void 0,function*(){var e=t.data;"update"===e?(this.emit("update"),this.close()):"cancel"===e&&(this._error("do not find a script tag"),this.close())})):this._error("Your browser does not support web workers.")})}close(){this.myWork&&(this.myWork.terminate(),this.myWork=void 0,this.emit("close"))}},e.useUploadFile=function(t,n){if("function"!=typeof t)throw new Error("the firse param muse be a function");if(n&&"function"!=typeof n)throw new Error("the secend param muse be a function");return{uploadFun:()=>{document.querySelectorAll('[data-id="upload"]').forEach(e=>{e.remove()});const e=document.createElement("input");e.setAttribute("style","display: none;"),e.setAttribute("data-id","upload"),e.setAttribute("type","file"),document.body.appendChild(e),e.focus(),e.click(),e.addEventListener("change",()=>c(this,void 0,void 0,function*(){e.files&&(0===e.files.length&&n("请选择文件"),t(e.files[0]),setTimeout(()=>{e.remove()},0))}))}}},e.version="0.0.4",Object.defineProperty(e,"__esModule",{value:!0})});